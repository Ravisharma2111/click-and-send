(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5820],{78655:function(e,i,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/customer/company/driver/form/[id]",function(){return r(19771)}])},19771:function(e,i,r){"use strict";r.r(i);var t=r(85893),a=r(83590),l=r(21425),n=r(26107),o=r(45844),c=r(63763),d=r(28482),s=r(11163),u=r(50841),_=r(46901),p=r(67294);let v=()=>{let{enqueueSnackbar:e}=(0,u.Ds)(),i=(0,s.useRouter)(),{id:r}=i.query,{user:n}=(0,l.E)(),v=(0,d.TA)({initialValues:{user_id:null==n?void 0:n.id,user_name:"",user_type:"driver",email:"",driver_type:"individual",mobile:"",term:"no",password:"",password_confirmation:"",company_certificate:"",company_certificate_url:"",company_vat:"",company_vat_url:"",profile_img:"",licence_front:"",licence_back:"",profile_img_url:"",licence_front_url:"",licence_back_url:"",address_proof:"",address_proof_url:"",insurance_cert:"",insurance_cert_url:"",transit_cert:"",transit_cert_url:"",liability_cert:"",liability_cert_url:"",vehicle_cert:"",vehicle_cert_url:"",v5c_cert:"",v5c_cert_url:"",dvia_cert:"",dvia_cert_url:"",nationality_cert:"",nationality_cert_url:"",document:"",register_number:"",password:"",password_confirmation:""},validate:e=>{let i={},t=/^(?=.*\d)(?=.*[!@#$%^&*])(?=.*[a-z])(?=.*[A-Z]).{8,16}$/;return e.user_name||(i.user_name="Full name is required"),e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(i.email="Invalid email address"):i.email="Email is required",e.mobile?/^[0-9]{11}$/.test(e.mobile)||(i.mobile="Please enter valid number"):i.mobile="Phone is required","create"===r&&(e.password?t.test(e.password)||(i.password="Min 8 letter password, with at least a symbol, upper and lower case letters and a number"):i.password="Password is required",e.password_confirmation?t.test(e.password_confirmation)?e.password&&e.password_confirmation&&e.password!=e.password_confirmation&&(i.password_confirmation="Password didn't match."):i.password_confirmation="Min 8 letter password, with at least a symbol, upper and lower case letters and a number":i.password_confirmation="Confirm password is required"),(null==e?void 0:e.user_type)!=="driver"||(e.profile_img||(i.profile_img="Driver Photo is required"),e.licence_front||(i.licence_front="Driver Licence is required"),e.licence_back||(i.licence_back="Driver Licence back is required"),e.address_proof||(i.address_proof="Address proof is required"),e.insurance_cert||(i.insurance_cert="Insurance Certificate is required"),e.transit_cert||(i.transit_cert="Transit Certificate is required"),e.liability_cert||(i.liability_cert="Liability Certificate is required"),e.vehicle_cert||(i.vehicle_cert="Vehicle Certificate is required"),e.v5c_cert||(i.v5c_cert="V5C Certificate is required"),e.dvia_cert||(i.dvia_cert="Dvia Certificate is required"),e.nationality_cert||(i.nationality_cert="Nationality Proof is required"),e.profile_img&&e.licence_front&&e.licence_back&&e.address_proof&&e.insurance_cert&&e.transit_cert&&e.liability_cert&&e.vehicle_cert&&e.v5c_cert&&e.dvia_cert&&e.nationality_cert||(i.document="Document is required")),(null==e?void 0:e.user_type)!=="company"||(e.company_certificate||(i.company_certificate="Company Certificate is required"),e.company_vat||(i.company_vat="Company Vat is required"),e.register_number||(i.register_number="Register Number is required")),i},onSubmit:async(a,l)=>{let o,{setErrors:d}=l;o="create"===r?"api/auth/company/add-driver/".concat(null==n?void 0:n.id):"api/auth/company/update-driver/".concat(r);let s=new FormData;s.append("user_name",null==a?void 0:a.user_name),s.append("user_type",null==a?void 0:a.user_type),s.append("email",null==a?void 0:a.email),s.append("mobile",null==a?void 0:a.mobile),s.append("term",null==a?void 0:a.term),s.append("password",null==a?void 0:a.password),s.append("driver_type",null==a?void 0:a.driver_type),s.append("user_id",null==n?void 0:n.id),s.append("password_confirmation",null==a?void 0:a.password_confirmation),s.append("profile_img",null==a?void 0:a.profile_img),s.append("licence_front",null==a?void 0:a.licence_front),s.append("licence_back",null==a?void 0:a.licence_back),s.append("address_proof",null==a?void 0:a.address_proof),s.append("insurance_cert",null==a?void 0:a.insurance_cert),s.append("transit_cert",null==a?void 0:a.transit_cert),s.append("liability_cert",null==a?void 0:a.liability_cert),s.append("vehicle_cert",null==a?void 0:a.vehicle_cert),s.append("v5c_cert",null==a?void 0:a.v5c_cert),s.append("dvia_cert",null==a?void 0:a.dvia_cert),s.append("nationality_cert",null==a?void 0:a.nationality_cert),await c.Z.post(o,s,{setErrors:d}).then(r=>{var a,l;(null==r?void 0:r.status)===200?(e((0,t.jsx)(_.Z,{style:{width:"100%",padding:"30px",backdropFilter:"blur(8px)",background:"#ff7533 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"success",children:null==r?void 0:null===(a=r.data)||void 0===a?void 0:a.message}),{variant:"success",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}}),v.resetForm(),i.push("/dashboard/company/driver/list")):e((0,t.jsx)(_.Z,{style:{width:"100%",padding:"30px",filter:blur("8px"),background:"#ffe9d5 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"error",children:null==r?void 0:null===(l=r.data)||void 0===l?void 0:l.error}),{variant:"error",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}})}).catch(i=>{var r,l;let{response:n}=i;if(422===n.status)for(let[e,i]of Object.entries(a))n.data.error[e]&&d({[e]:n.data.error[e][0]});(null==n?void 0:null===(r=n.data)||void 0===r?void 0:r.status)===406&&e((0,t.jsx)(_.Z,{style:{width:"100%",padding:"30px",filter:blur("8px"),background:"#ffe9d5 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"error",children:null==n?void 0:null===(l=n.data)||void 0===l?void 0:l.error}),{variant:"error",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}})})}});p.useEffect(()=>{v.setFieldValue("user_id",null==n?void 0:n.id)},[n,null==n?void 0:n.id]),console.log("formk123",v);let f=async()=>{await c.Z.get("/api/auth/company/edit-driver/".concat(r)).then(e=>{if(200===e.status&&200===e.status){var i,r,t;if((null==e?void 0:null===(r=e.data)||void 0===r?void 0:null===(i=r.view_data)||void 0===i?void 0:i.length)>0){let i=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.view_data[0];for(let[e]of Object.entries(v.values))i[e]?v.setFieldValue([e],i[e]):v.setFieldValue([e],"");v.setFieldValue("profile_img_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.profile_img)),console.log("ddd",i),v.setFieldValue("licence_front_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.licence_front)),v.setFieldValue("licence_back_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.licence_back)),v.setFieldValue("address_proof_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.address_proof)),v.setFieldValue("insurance_cert_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.insurance_cert)),v.setFieldValue("transit_cert_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.transit_cert)),v.setFieldValue("liability_cert_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.liability_cert)),v.setFieldValue("vehicle_cert_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.vehicle_cert)),v.setFieldValue("v5c_cert_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.v5c_cert)),v.setFieldValue("dvia_cert_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.dvia_cert)),v.setFieldValue("nationality_cert_url","".concat(null==i?void 0:i.base_url).concat(null==i?void 0:i.nationality_cert))}}}).catch(e=>{console.log("eee",e)})};return p.useEffect(()=>{r&&"create"!==r&&f()},[r]),(0,t.jsx)(a.Z,{children:(0,t.jsx)(o.Z,{formik:v})})};v.getLayout=function(e){return(0,t.jsx)(n.l,{children:e})},i.default=v}},function(e){e.O(0,[4885,1810,678,3827,1994,6034,4815,8251,4576,5981,6107,5324,6283,9774,2888,179],function(){return e(e.s=78655)}),_N_E=e.O()}]);