(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4319],{95668:function(i,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/customer/job_history/detail/[id]",function(){return n(88738)}])},83590:function(i,e,n){"use strict";n.d(e,{Z:function(){return x}});var l=n(85893),t=n(45697),r=n.n(t),d=n(67294),o=n(11163),s=n(21425),a=n(94717);n(26107);var c=n(50261),h=n(87357),u=n(46574);function x(i){let{children:e}=i,{isAuthenticated:n,isInitialized:t}=(0,s.E)(),{pathname:r,push:x}=(0,o.useRouter)(),[v,j]=(0,d.useState)(null);return((0,d.useEffect)(()=>{v&&r!==v&&x(v),n&&j(null)},[n,r,x,v]),t)?n?(0,l.jsxs)(l.Fragment,{children:[" ",e," "]}):(r!==v&&j(r),(0,l.jsx)(a.Z,{})):(0,l.jsx)(h.Z,{mt:10,children:(0,l.jsx)(u.Z,{children:(0,l.jsx)(c.Z,{})})})}x.propTypes={children:r().node}},88738:function(i,e,n){"use strict";n.r(e),n.d(e,{default:function(){return V}});var l=n(85893),t=n(83590),r=n(26107),d=n(21425),o=n(38308),s=n(79582),a=n(63763),c=n(87357),h=n(46574),u=n(69417),x=n(66242),v=n(15861),j=n(67720),p=n(44267),Z=n(51233),m=n(72882),g=n(7906),b=n(53184),f=n(53816),y=n(53252),w=n(295),_=n(91440),C=n(11994),k=n(64666),R=n(6514),S=n(28482),W=n(11163),D=n(50841),z=n(46901),A=n(67294),E=()=>{var i,e,n,t;let r=(0,W.useRouter)(),{user:E}=(0,d.E)(),{enqueueSnackbar:T}=(0,D.Ds)(),{id:V}=r.query,[q,N]=(0,A.useState)([]),[F,O]=(0,A.useState)([]),[P,H]=(0,A.useState)([]),[I,L]=A.useState(!1),[Q,X]=A.useState(!1),[B,J]=(0,A.useState)(!1),M=(0,S.TA)({initialValues:{job_id:"",user_id:"",given_by:"customer",rating:"",review:""},validate:i=>{let e={};return i.review||(e.review="Note is required"),i.rating||(e.rating="Rating is required"),e},onSubmit:async i=>{await a.Z.post("api/auth/rating/add",M.values).then(i=>{if(200===i.status){var e;M.handleReset(),L(!1),T((0,l.jsx)(z.Z,{style:{width:"100%",padding:"30px",backdropFilter:"blur(8px)",background:"#ff7533 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"success",children:null==i?void 0:null===(e=i.data)||void 0===e?void 0:e.message}),{variant:"success",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}}),G(),handleClose(!0)}}).catch(i=>{console.log(i)})}}),G=async()=>{await a.Z.get("api/auth/jobs/view/".concat(V)).then(i=>{var e,n,l;(null==i?void 0:i.status)===200&&(N(null==i?void 0:null===(e=i.data)||void 0===e?void 0:e.view_data),O(null==i?void 0:null===(l=i.data)||void 0===l?void 0:null===(n=l.view_data)||void 0===n?void 0:n.ratings))}).catch(i=>{console.log("error",i)})};A.useEffect(()=>{V&&G()},[V]),(0,A.useEffect)(()=>{M.setFieldValue("user_id",null==E?void 0:E.id),M.setFieldValue("job_id",V)},[E,null==E?void 0:E.id,V]);let K=async i=>{let e=i.find(i=>"customer"===i.given_by);await a.Z.get("api/auth/rating/view/".concat(e.id)).then(i=>{if((null==i?void 0:i.status)===200){H(i.data.view_data);let{rating:e,review:n}=i.data.view_data;$.setValues({rating:e,review:n}),X(!0)}}).catch(i=>{console.log("error",i)})},U=async(i,e)=>{await a.Z.post("api/auth/rating/update/".concat(i),e).then(i=>{if(200===i.status){var e;$.handleReset(),X(!1),T((0,l.jsx)(z.Z,{style:{width:"100%",padding:"30px",backdropFilter:"blur(8px)",background:"#ff7533 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"success",children:null==i?void 0:null===(e=i.data)||void 0===e?void 0:e.message}),{variant:"success",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}}),G(),handleClose(!0)}}).catch(i=>{console.log(i)})},Y=async i=>{P&&P.id?U(P.id,i):console.log("Rating ID not available")},$=(0,S.TA)({initialValues:{job_id:"",user_id:"",given_by:"customer",rating:"",review:""},validate:i=>{let e={};return i.review||(e.review="Note is required"),i.rating||(e.rating="Rating is required"),e},onSubmit:Y});return(0,l.jsxs)(A.Fragment,{children:[(0,l.jsx)(c.Z,{mt:10,pb:12,children:(0,l.jsx)(h.Z,{children:(0,l.jsxs)(c.Z,{my:4,children:[(0,l.jsxs)(u.Z,{variant:"outlined",sx:{my:2},onClick:()=>r.push("/dashboard/customer/job_history"),children:[(0,l.jsx)(s.Z,{icon:"ion:play-back",sx:{mr:"7px"},width:14}),"Back"]}),(0,l.jsxs)(x.Z,{sx:{position:"relative"},children:[(0,l.jsx)(v.Z,{textAlign:"center",variant:"h6",my:1,fontSize:17,children:"Job Detail"}),(0,l.jsx)(j.Z,{}),(0,l.jsxs)(p.Z,{children:[(0,l.jsx)(v.Z,{variant:"h4",component:"h4",textAlign:"center",children:null==q?void 0:null===(i=q.job)||void 0===i?void 0:i.name}),(0,l.jsxs)(Z.Z,{direction:"row",justifyContent:"center",alignItems:"center",spacing:2,my:1,children:[(0,l.jsx)(v.Z,{component:"p",variant:"body2",fontWeight:500,children:"Vehicle Requirment:"}),(0,l.jsx)(v.Z,{component:"p",variant:"body2",fontWeight:600,children:null==q?void 0:null===(e=q.job)||void 0===e?void 0:e.vehicle})]}),(0,l.jsx)(j.Z,{sx:{my:4}}),(0,l.jsxs)(c.Z,{children:[(0,l.jsx)(v.Z,{component:"p",variant:"body1",fontWeight:500,textAlign:"center",mb:2,children:"Pickup Details"}),(0,l.jsx)(m.Z,{sx:{borderRadius:"10px",border:"1px solid",borderColor:i=>i.palette.primary.main},children:(0,l.jsxs)(g.Z,{"aria-label":"simple table",sx:{minWidth:"100%"},children:[(0,l.jsx)(b.Z,{children:(0,l.jsxs)(f.Z,{children:[(0,l.jsx)(y.Z,{align:"left",children:"Address"}),(0,l.jsx)(y.Z,{align:"left",children:"Pickup Date"}),(0,l.jsx)(y.Z,{align:"left",children:"Pickup Time"}),(0,l.jsx)(y.Z,{align:"left",children:"L*W*H"}),(0,l.jsx)(y.Z,{align:"left",children:"Quantity"}),(0,l.jsx)(y.Z,{align:"left",children:"Image"}),(0,l.jsx)(y.Z,{align:"left",children:"Material"})]})}),(0,l.jsx)(w.Z,{children:(null==q?void 0:q.pickup)&&(null==q?void 0:null===(n=q.pickup)||void 0===n?void 0:n.length)>0&&(null==q?void 0:q.pickup.map((i,e)=>{var n,t,r,d,o,s,a,h,u;return(0,l.jsxs)(f.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,l.jsx)(y.Z,{component:"th",scope:"row",children:(0,l.jsx)(v.Z,{component:"p",variant:"body2",children:null==i?void 0:i.address})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(v.Z,{component:"p",variant:"body2",children:null==i?void 0:null===(n=i.item)||void 0===n?void 0:n.pickup_date})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(v.Z,{component:"p",variant:"body2",children:null==i?void 0:null===(t=i.item)||void 0===t?void 0:t.pickup_time})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(v.Z,{component:"p",variant:"body2",children:"".concat(null==i?void 0:null===(r=i.item)||void 0===r?void 0:r.length," * ").concat(null==i?void 0:null===(d=i.item)||void 0===d?void 0:d.width," * ").concat(null==i?void 0:null===(o=i.item)||void 0===o?void 0:o.height)})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(v.Z,{component:"p",variant:"body2",children:null==i?void 0:null===(s=i.item)||void 0===s?void 0:s.quantity})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(c.Z,{children:(0,l.jsx)(c.Z,{component:"img",m:"auto",src:"".concat(null==i?void 0:null===(a=i.item)||void 0===a?void 0:a.base_url).concat(null==i?void 0:null===(h=i.item)||void 0===h?void 0:h.image),width:80})})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(v.Z,{component:"p",variant:"body2",children:null==i?void 0:null===(u=i.item)||void 0===u?void 0:u.material})})]},"jobDetail".concat(e))}))})]})})]}),(0,l.jsx)(j.Z,{sx:{my:4}}),(0,l.jsxs)(c.Z,{children:[(0,l.jsx)(v.Z,{component:"p",variant:"body1",fontWeight:500,textAlign:"center",mb:2,children:"Delivery Details"}),(0,l.jsx)(m.Z,{sx:{borderRadius:"10px",border:"1px solid",borderColor:i=>i.palette.primary.main},children:(0,l.jsxs)(g.Z,{"aria-label":"simple table",sx:{minWidth:"100%"},children:[(0,l.jsx)(b.Z,{children:(0,l.jsxs)(f.Z,{children:[(0,l.jsx)(y.Z,{align:"left",children:"Address"}),(0,l.jsx)(y.Z,{align:"left",children:"Delivery Date"}),(0,l.jsx)(y.Z,{align:"left",children:"Delivery Time"}),(0,l.jsx)(y.Z,{align:"left",children:"Quantity"})]})}),(0,l.jsx)(w.Z,{children:(null==q?void 0:q.drop)&&(null==q?void 0:null===(t=q.drop)||void 0===t?void 0:t.length)>0&&(null==q?void 0:q.drop.map((i,e)=>{var n,t,r;return(0,l.jsxs)(f.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,l.jsx)(y.Z,{component:"th",scope:"row",children:(0,l.jsx)(v.Z,{component:"p",variant:"body2",children:null==i?void 0:i.address})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(v.Z,{component:"p",variant:"body2",children:null==i?void 0:null===(n=i.item)||void 0===n?void 0:n.drop_date})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(v.Z,{component:"p",variant:"body2",children:null==i?void 0:null===(t=i.item)||void 0===t?void 0:t.drop_time})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(v.Z,{component:"p",variant:"body2",children:null==i?void 0:null===(r=i.item)||void 0===r?void 0:r.quantity})})]},"jobDetail".concat(e))}))})]})})]}),(0,l.jsxs)(c.Z,{my:4,children:[(0,l.jsx)(j.Z,{}),(0,l.jsxs)(c.Z,{my:3,children:[(0,l.jsx)(c.Z,{textAlign:"right",children:F&&F.some(i=>i.id==i.id)&&F.some(i=>"customer"===i.given_by)?(0,l.jsx)(u.Z,{variant:"outlined",onClick:()=>K(F),children:"Edit Rating"}):(0,l.jsx)(u.Z,{variant:"outlined",onClick:()=>L(!0),children:"+ Add Rating"})}),(0,l.jsx)(c.Z,{children:(0,l.jsx)(v.Z,{textAlign:"center",variant:"h4",children:"Rating & Reviews"})})]}),F&&(null==F?void 0:F.length)>0&&F.map((i,e)=>{var n,t,r;return(0,l.jsxs)(c.Z,{children:[(0,l.jsxs)(Z.Z,{spacing:3,direction:"row",py:2,children:[(0,l.jsx)(c.Z,{component:"img",src:"".concat(null==i?void 0:null===(n=i.user)||void 0===n?void 0:n.base_url).concat(null==i?void 0:null===(t=i.user)||void 0===t?void 0:t.profile_img),width:60,height:60,sx:{objectFit:"cover"}}),(0,l.jsxs)(Z.Z,{direction:"column",children:[(0,l.jsx)(c.Z,{children:(0,l.jsx)(v.Z,{fontSize:16,fontWeight:500,color:"primary",children:null==i?void 0:null===(r=i.user)||void 0===r?void 0:r.user_name})}),(0,l.jsx)(c.Z,{children:(0,l.jsx)(_.Z,{value:null==i?void 0:i.rating,readOnly:!0,size:"small"})}),(0,l.jsx)(c.Z,{children:(0,l.jsx)(v.Z,{fontSize:14,children:null==i?void 0:i.review})})]})]}),(0,l.jsx)(j.Z,{})]},e)})]})]})]})]})})}),(0,l.jsx)(C.Z,{open:B,onClose:()=>J(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,l.jsx)(c.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",bgcolor:"background.paper",boxShadow:24,borderRadius:"10px",p:4},children:(0,l.jsx)(m.Z,{sx:{borderRadius:"10px",border:"1px solid",borderColor:i=>i.palette.grey[300]},children:(0,l.jsxs)(g.Z,{"aria-label":"simple table",children:[(0,l.jsx)(b.Z,{children:(0,l.jsxs)(f.Z,{children:[(0,l.jsx)(y.Z,{align:"left",children:"Sr. No."}),(0,l.jsx)(y.Z,{align:"left",children:"Address"})]})}),(0,l.jsx)(w.Z,{children:B&&(null==B?void 0:B.length)>0&&B.map((i,e)=>(0,l.jsxs)(f.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,l.jsx)(y.Z,{component:"th",scope:"row",children:(0,l.jsx)(v.Z,{children:e+1})}),(0,l.jsx)(y.Z,{align:"left",children:(0,l.jsx)(v.Z,{sx:{maxWidth:"52em",wordWrap:"break-word"},children:null==i?void 0:i.address})})]},"jobDetail".concat(e)))})]})})})}),(0,l.jsx)(k.Z,{open:I,onClose:i=>L(i),maxWidth:"xs",fullWidth:!0,children:(0,l.jsx)(R.Z,{sx:{my:3},children:(0,l.jsxs)(c.Z,{component:"form",noValidate:!0,onSubmit:M.handleSubmit,children:[(0,l.jsx)(c.Z,{align:"right",children:(0,l.jsx)(s.Z,{icon:"basil:cross-solid",width:20,onClick:()=>L(!1),sx:{border:"1px solid grey",borderRadius:"50%",cursor:"pointer"}})}),(0,l.jsx)(v.Z,{mb:2,variant:"subtitle1",children:"Review"}),(0,l.jsxs)(Z.Z,{spacing:1,children:[(0,l.jsx)(c.Z,{children:(0,l.jsx)(_.Z,{value:M.values.rating,onChange:M.handleChange,name:"rating",helperText:M.touched.rating&&M.errors.rating})}),(0,l.jsx)(c.Z,{children:(0,l.jsx)(o.zC,{size:"small",name:"review",label:"Review",fullWidth:!0,multiline:!0,rows:"4",value:M.values.review,onChange:M.handleChange,helperText:M.touched.review&&M.errors.review})})]}),(0,l.jsx)(Z.Z,{direction:"row",spacing:8,children:(0,l.jsx)(u.Z,{fullWidth:!0,variant:"outlined",type:"submit",children:"Submit"})})]})})}),(0,l.jsx)(k.Z,{open:Q,onClose:i=>X(i),maxWidth:"xs",fullWidth:!0,children:(0,l.jsx)(R.Z,{sx:{my:3},children:(0,l.jsxs)(c.Z,{component:"form",noValidate:!0,onSubmit:$.handleSubmit,children:[(0,l.jsx)(c.Z,{align:"right",children:(0,l.jsx)(s.Z,{icon:"basil:cross-solid",width:20,onClick:()=>X(!1),sx:{border:"1px solid grey",borderRadius:"50%",cursor:"pointer"}})}),(0,l.jsx)(v.Z,{mb:2,variant:"subtitle1",children:"Review"}),(0,l.jsxs)(Z.Z,{spacing:1,children:[(0,l.jsx)(c.Z,{children:(0,l.jsx)(_.Z,{value:$.values.rating,onChange:$.handleChange,name:"rating",helperText:$.touched.rating&&$.errors.rating})}),(0,l.jsx)(c.Z,{children:(0,l.jsx)(o.zC,{size:"small",name:"review",label:"Review",fullWidth:!0,multiline:!0,rows:"4",value:$.values.review,onChange:$.handleChange,helperText:$.touched.review&&$.errors.review})})]}),(0,l.jsx)(Z.Z,{direction:"row",spacing:8,children:(0,l.jsx)(u.Z,{fullWidth:!0,variant:"outlined",type:"submit",children:"Submit"})})]})})})]})};let T=()=>(0,l.jsx)(t.Z,{children:(0,l.jsx)(E,{})});T.getLayout=function(i){return(0,l.jsx)(r.l,{children:i})};var V=T}},function(i){i.O(0,[4885,1810,678,3827,1994,6034,4815,8251,4576,1440,659,5981,6107,5324,9774,2888,179],function(){return i(i.s=95668)}),_N_E=i.O()}]);