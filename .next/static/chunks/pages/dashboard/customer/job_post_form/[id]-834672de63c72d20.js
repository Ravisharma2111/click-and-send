(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{25233:function(e,i,d){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/customer/job_post_form/[id]",function(){return d(26866)}])},26866:function(e,i,d){"use strict";d.r(i);var t=d(85893),l=d(67294),o=d(26107),r=d(28482),n=d(53196),s=d(711),u=d.n(s),a=d(41609),v=d.n(a),c=d(43063),p=d.n(c),h=d(63763),m=d(50841),g=d(46901),f=d(11163),_=d(83590),x=d(21425),y=d(64303),b=d(6049);let k=()=>{let{enqueueSnackbar:e}=(0,m.Ds)(),i=(0,f.useRouter)(),{id:d}=i.query,{user:o}=(0,x.E)(),{value:s,setValue:a}=(0,l.useContext)(y.E),c=2===s,k={address:"",lat:0,long:0,type:"pickup",pin_code:""},w={address:"",lat:0,long:0,type:"drop",pin_code:""},q={product:{image:"",height:"",length:"",width:"",material:"",pickup_date:"",pickup_time:"",drop_date:"",drop_time:""},address:[k,w]},O=(e,i)=>{var d,t,l,o;i.items=[];let r=[],n={},s={};return(null==e?void 0:e.items)&&(null==e?void 0:null===(d=e.items)||void 0===d?void 0:d.length)>0&&(null==e||e.items.forEach((e,d)=>{var t,l,o,u,a,v,c,p,h,m,g;n.product={},(null==e?void 0:null===(t=e.address)||void 0===t?void 0:t.length)&&e.address.forEach((e,i)=>{var d,t;s=(null==e?void 0:e.address)?{address:"",index:i}:{address:"Address is required",index:i},s=(null==e?void 0:e.pin_code)?(null==e?void 0:null===(d=e.pin_code)||void 0===d?void 0:d.length)<5||(null==e?void 0:null===(t=e.pin_code)||void 0===t?void 0:t.length)>8?{...s,pin_code:"Min 5 digit and Max 8 digit is required",index:i}:{...s,pin_code:"",index:i}:{...s,pin_code:"Post Code is required",index:i},r.push(s),n.address=r,s={}}),n.product.index=d,(null==e?void 0:null===(l=e.product)||void 0===l?void 0:l.image)?n.product.image="":n.product.image="Image is required",(null==e?void 0:null===(o=e.product)||void 0===o?void 0:o.height)?n.product.height="":n.product.height="Height is required",(null==e?void 0:null===(u=e.product)||void 0===u?void 0:u.length)?n.product.length="":n.product.length="Length is required",(null==e?void 0:null===(a=e.product)||void 0===a?void 0:a.width)?n.product.width="":n.product.width="Width is required",(null==e?void 0:null===(v=e.product)||void 0===v?void 0:v.material)?n.product.material="":n.product.material="Material is required",(null==e?void 0:null===(c=e.product)||void 0===c?void 0:c.pickup_date)?n.product.pickup_date="":n.product.pickup_date="Pickup date is required",(null==e?void 0:null===(p=e.product)||void 0===p?void 0:p.pickup_time)?n.product.pickup_time="":n.product.pickup_time="Pickup time is required",(null==e?void 0:null===(h=e.product)||void 0===h?void 0:h.drop_date)?n.product.drop_date="":n.product.drop_date="Delivery date is required",(null==e?void 0:null===(m=e.product)||void 0===m?void 0:m.drop_time)?n.product.drop_time="":n.product.drop_time="Delivery time is required",(null==e?void 0:null===(g=e.product)||void 0===g?void 0:g.quantity)?n.product.quantity="":n.product.quantity="Quantity is required",i.items.push({...n,address:r}),n={},r=[],s={}})),(null===(l=i)||void 0===l?void 0:null===(t=l.items)||void 0===t?void 0:t.length)&&u()(null===(o=i)||void 0===o?void 0:o.items,e=>{var i,d,t,l,o,r,n,s,a;let c=!1;return(null==e?void 0:e.address)&&(c=u()(null==e?void 0:e.address,e=>!(null==e?void 0:e.address))),!!(v()(null==e?void 0:null===(i=e.product)||void 0===i?void 0:i.image)&&v()(null==e?void 0:null===(d=e.product)||void 0===d?void 0:d.height)&&v()(null==e?void 0:null===(t=e.product)||void 0===t?void 0:t.length)&&v()(null==e?void 0:null===(l=e.product)||void 0===l?void 0:l.width)&&v()(null==e?void 0:null===(o=e.product)||void 0===o?void 0:o.material)&&v()(null==e?void 0:null===(r=e.product)||void 0===r?void 0:r.pickup_date)&&v()(null==e?void 0:null===(n=e.product)||void 0===n?void 0:n.pickup_time)&&v()(null==e?void 0:null===(s=e.product)||void 0===s?void 0:s.drop_date)&&v()(null==e?void 0:null===(a=e.product)||void 0===a?void 0:a.drop_time))&&!!c})&&(i=delete i.items),i},j=(0,r.TA)({initialValues:{user_id:null==o?void 0:o.id,created_by:null==o?void 0:o.user_type,name:"",vehicle:0,vehical_type:0,items:[q],description:""},validate:e=>{var i;let d={};return e.name||(d.name="Job Title is required"),(null==e?void 0:null===(i=e.items)||void 0===i?void 0:i.length)&&O(e,d),e.vehicle||(d.vehicle="Vehicle is required"),e.vehical_type||(d.vehical_type="Vehicle Type is required"),e.description||(d.description="Description is required"),d},onSubmit:async(l,o)=>{let r,n,{setErrors:u,setFieldValue:v}=o;console.log("values values",l),"create"===d?(r="/api/auth/jobs/add",n="POST"):(r="/api/auth/jobs/update/".concat(d),n="POST"),"create"!==d?(l.items=JSON.stringify(null==l?void 0:l.items),await h.Z.request({url:r,method:n,data:l}).then(d=>{var o,r;(null==d?void 0:d.status)===200?(v("items",JSON.parse(null==l?void 0:l.items)),i.push("/dashboard/customer/job_posted"),e((0,t.jsx)(g.Z,{style:{width:"100%",padding:"30px",backdropFilter:"blur(8px)",background:"#ff7533 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"success",children:null==d?void 0:null===(o=d.data)||void 0===o?void 0:o.message}),{variant:"success",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}})):(v("items",JSON.parse(null==l?void 0:l.items)),e((0,t.jsx)(g.Z,{style:{width:"100%",padding:"30px",filter:blur("8px"),background:"#ffe9d5 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"error",children:null==d?void 0:null===(r=d.data)||void 0===r?void 0:r.error}),{variant:"error",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}}))}).catch(i=>{var d,o;v("items",JSON.parse(null==l?void 0:l.items));let{response:r}=i;if(422===r.status)for(let[e]of(console.log("response",r.data.error),Object.entries(l)))r.data.error[e]&&u({[e]:r.data.error[e][0]});(null==r?void 0:null===(d=r.data)||void 0===d?void 0:d.status)===406&&e((0,t.jsx)(g.Z,{style:{width:"100%",padding:"30px",filter:blur("8px"),background:"#ffe9d5 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"error",children:null==r?void 0:null===(o=r.data)||void 0===o?void 0:o.error}),{variant:"error",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}})})):c?(l.items=JSON.stringify(null==l?void 0:l.items),await h.Z.request({url:r,method:n,data:l}).then(d=>{var o,r;(null==d?void 0:d.status)===200?(v("items",JSON.parse(null==l?void 0:l.items)),i.push("/dashboard/customer/job_posted"),e((0,t.jsx)(g.Z,{style:{width:"100%",padding:"30px",backdropFilter:"blur(8px)",background:"#ff7533 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"success",children:null==d?void 0:null===(o=d.data)||void 0===o?void 0:o.message}),{variant:"success",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}})):(v("items",JSON.parse(null==l?void 0:l.items)),e((0,t.jsx)(g.Z,{style:{width:"100%",padding:"30px",filter:blur("8px"),background:"#ffe9d5 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"error",children:null==d?void 0:null===(r=d.data)||void 0===r?void 0:r.error}),{variant:"error",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}}))}).catch(i=>{var d,o;v("items",JSON.parse(null==l?void 0:l.items));let{response:r}=i;if(422===r.status)for(let[e]of(console.log("response",r.data.error),Object.entries(l)))r.data.error[e]&&u({[e]:r.data.error[e][0]});(null==r?void 0:null===(d=r.data)||void 0===d?void 0:d.status)===406&&e((0,t.jsx)(g.Z,{style:{width:"100%",padding:"30px",filter:blur("8px"),background:"#ffe9d5 ",fontSize:"19px",fontWeight:800,lineHeight:"30px"},icon:!1,severity:"error",children:null==r?void 0:null===(o=r.data)||void 0===o?void 0:o.error}),{variant:"error",iconVariant:!0,anchorOrigin:{vertical:"top",horizontal:"center"}})})):a(s+1)}});l.useEffect(()=>{j.setFieldValue("user_id",null==o?void 0:o.id)},[o,null==o?void 0:o.id]);let S=async()=>{await h.Z.get("/api/auth/master/jobs/edit/".concat(d)).then(e=>{if(200===e.status){var i,d;if(null==e?void 0:null===(i=e.data)||void 0===i?void 0:i.view_data){let i=null==e?void 0:null===(d=e.data)||void 0===d?void 0:d.view_data;for(let[e]of Object.entries(j.values))j.setFieldValue([e],i[e])}}})};return l.useEffect(()=>{d&&"create"!==d&&S()},[d]),console.log("formik",j),(0,t.jsxs)(_.Z,{children:[(0,t.jsx)(n.Z,{addProduct:()=>{j.setFieldValue("items",[...j.values.items||[],q])},addSingleAddress:()=>{let e=j.values.items.map(e=>{e.address||(e.address=[]);let i={...k,isNew:!0,id:e.address.length+1};return e.address.push(i),e});j.setFieldValue("items",e)},addSingleAddress1:()=>{let e=j.values.items.map(e=>{e.address||(e.address=[]);let i={...w,isNew:!0,id:e.address.length+1};return e.address.push(i),e});j.setFieldValue("items",e)},removeProduct:e=>{var i;if(null==j?void 0:null===(i=j.values)||void 0===i?void 0:i.items){let i=j.values.items.splice(e,1);j.setFieldValue("items",p()(j.values.items,i))}},removesAddress:(e,i)=>{console.log(j.values.items[e].address,i,"sdfa");let d=[...j.values.items],t=d[e];if(t&&t.address){let e=t.address.filter(e=>e.id!==i);t.address=e,j.setFieldValue("items",d)}},removeAddress:(e,i)=>{var d,t,l;if(null==j?void 0:null===(d=j.values)||void 0===d?void 0:d.items){let d=null===(t=j.values.items[e])||void 0===t?void 0:t.address.splice(i,1);j.setFieldValue("items[".concat(e,"].address"),p()(null===(l=j.values.items[e])||void 0===l?void 0:l.address,d))}},formik:j}),(0,t.jsx)(b.Z,{})]})};k.getLayout=function(e){return(0,t.jsx)(o.l,{children:e})},i.default=k}},function(e){e.O(0,[4885,1810,678,3827,1994,6034,4815,8251,4576,763,5981,6107,5324,6979,9774,2888,179],function(){return e(e.s=25233)}),_N_E=e.O()}]);